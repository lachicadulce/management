<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <title>거래처</title>

    <SCRIPT LANGUAGE="JavaScript">
  <!--
		var setValue = function(id, value){
			document.getElementById(id).value = value;
		}


		var getValue = function(id, retObject){
			var value = document.getElementById(id).value;
			retObject["VALUE"] = value;
		}


		var sendRowInfo = function(td){
		    var info = td.getAttribute("code") + "," + td.getAttribute("cust_code");
            top.window.postMessage(info, "http://10.10.70.130:8080");
		}
  //-->
  </SCRIPT>
</head>
<body>
    <div>
        <h2>▶ 거래처 관리</h2>
        <form th:action="@{/cust/search}" method="get">
            <div class="mb-3 input-group">
                <span class="input-group-text">검색</span>
                <input type="text" class="form-control" name="cust_code" placeholder="거래처 번호" />
                <input type="text" class="form-control" name="cust_name" placeholder="거래처 이름" />
                <button  type="submit" class="btn btn-secondary">조회</button>
            </div>
        </form>
        <form th:action="@{/cust/insert}" method="get">
            <div class="mb-3 input-group">
                <span class="input-group-text">추가</span>
                <input type="text" class="form-control" name="cust_code" placeholder="거래처 번호"/>
                <input type="text" class="form-control" name="cust_name" placeholder="거래처 이름"/>
                <button  type="submit" class="btn btn-secondary">추가</button>
            </div>
        </form>
        <table class="table table-striped">
            <thead>
            <tr>
                <th></th>
                <th>회사</th>
                <th>사업장</th>
                <th>거래처번호</th>
                <th>거래처명</th>
                <th>상호</th>
                <th>거래처상태</th>
                <th>신용등급</th>
                <th>사업자번호</th>
                <th>대표자성명</th>
                <th>법인번호</th>
                <th>주민등록번호</th>
                <th>업태</th>
                <th>종목</th>
                <th>전화번호</th>
                <th>세무사업자주소</th>
                <th>거래처종류</th>
                <th>국가</th>
                <th>유통구조</th>
                <th>영문회사명</th>
                <th>팩스번호</th>
                <th>주소</th>
                <th>영문주소</th>
                <th>이메일</th>
                <th>홈페이지</th>
                <th>첨부파일</th>
                <th>거래처설명</th>
                <th>대표담당자</th>
                <th>작성일자</th>
                <th>수정일자</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="cust : ${custs}">
                <td>
                    <form th:action="@{/cust/select}" method="get">
                        <input type="hidden" name="cust_code" th:value="${cust.cust_code}"/>
                        <input type="hidden" name="cust_name" th:value="${cust.cust_name}"/>
                        <input type="submit" value="수정하기" class="btn btn-success"/>
                    </form>
                    <form th:action="@{/cust/delete}" method="get">
                        <input type="hidden" name="cust_code" th:value="${cust.cust_code}"/>
                        <input type="hidden" name="cust_name" th:value="${cust.cust_name}"/>
                        <input type="button" value="삭제하기" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#exampleModal"/>
                        <!-- Modal -->
                        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="exampleModalLabel">삭제 확인</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        정말 삭제하시겠습니까?
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                                        <button type="submit" class="btn btn-primary">확인</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>

                </td>
                <td th:text="${cust.company}" onclick="sendRowInfo(this);" th:code="${cust.company}" th:cust_code="${cust.cust_code}"></td>
                <td th:text="${cust.business_unit}"></td>
                <td th:text="${cust.cust_code}"></td>
                <td th:text="${cust.cust_name}"></td>
                <td th:text="${cust.cust_desc}"></td>
                <td th:text="${cust.status}"></td>
                <td th:text="${cust.grade}"></td>
                <td th:text="${cust.reg_num}"></td>
                <td th:text="${cust.cust_rename}"></td>
                <td th:text="${cust.cust_reno}"></td>
                <td th:text="${cust.res_no}"></td>
                <td th:text="${cust.business_stat}"></td>
                <td th:text="${cust.business_item}"></td>
                <td th:text="${cust.tel_no}"></td>
                <td th:text="${cust.tax_address}"></td>
                <td th:text="${cust.cust_kind}"></td>
                <td th:text="${cust.nation}"></td>
                <td th:text="${cust.distribution}"></td>
                <td th:text="${cust.cust_eng_name}"></td>
                <td th:text="${cust.fax_no}"></td>
                <td th:text="${cust.address}"></td>
                <td th:text="${cust.eng_address}"></td>
                <td th:text="${cust.email_address}"></td>
                <td th:text="${cust.homepage}"></td>
                <td th:text="${cust.attached_file}"></td>
                <td th:text="${cust.cust_explain}"></td>
                <td th:text="${cust.cust_charge}"></td>
                <td th:text="${cust.create_date}"></td>
                <td th:text="${cust.modify_date}"></td>
            </tr>
            </tbody>
        </table>

    </div>
    <div>
        <nav style="text-align: center;">
            <!--표에 사용될 변수값 초기화 -->
            <ul class="pagination nav justify-content-center" th:with="start=${T(java.lang.Math).floor(custs.number/10)*10 + 1}, last=(${start + 9 < custs.totalPages ? start + 9 : custs.totalPages})">
                <th:block th:with="
                firstAddr=@{/custs(page=1)},
                prevAddr=@{/custs(page=${custs.number})},
                nextAddr=@{/custs(page=${custs.number + 2})},
                lastAddr=@{/custs(page=${custs.totalPages})}" class="nav">
                    <li class="nav-item">
                        <a class="nav-link"  th:href="${firstAddr}" aria-label="First">
                            <span aria-hidden="true">First</span>
                        </a>
                    </li>
                    <!-- 이전 페이지로 가기 버튼 -->
                    <li th:class="${custs.first} ? 'disabled'" class="nav-item">
                        <a class="nav-link"  th:href="${custs.first} ? '#' :${prevAddr}" aria-label="Previous">
                            <span aria-hidden="true">&lt;</span>
                        </a>
                    </li>
                    <!--1,2,3,4,.. 등 페이지-->
                    <li th:each="page: ${#numbers.sequence(start, last)}"
                        th:class="${page == custs.number + 1} ? 'nav-link disabled'" class="nav-item">
                        <a class="nav-link"  th:text="${page}" th:href="@{/custs(page=${page})}"></a>
                    </li>
                    <!--다음 페이지로 -->
                    <li th:class="${custs.last} ? 'disabled'" class="nav-item">
                        <a class="nav-link"  th:href="${custs.last} ? '#' : ${nextAddr}" aria-label="Next">
                            <span aria-hidden="true">&gt;</span>
                        </a>
                    </li>
                    <!--맨 마지막 페이지로 이동 -->
                    <li class="nav-item">
                        <a class="nav-link"  th:href="${lastAddr}" aria-label="Last">
                            <span aria-hidden="true">Last</span>
                        </a>
                    </li>
                </th:block>
            </ul>
        </nav>
    </div>
</body>
</html>